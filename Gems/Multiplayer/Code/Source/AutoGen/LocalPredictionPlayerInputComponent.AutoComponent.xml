<?xml version="1.0"?>

<Component
    Name="LocalPredictionPlayerInputComponent" 
    Namespace="Multiplayer" 
    OverrideComponent="true" 
    OverrideController="true" 
    OverrideInclude="Source/Components/LocalPredictionPlayerInputComponent.h"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <ComponentRelation Constraint="Weak" HasController="true" Name="NetworkTransformComponent" Namespace="Multiplayer" Include="Source/Components/NetworkTransformComponent.h" />

    <Include File="Include/MultiplayerTypes.h"/>
    <Include File="Source/NetworkInput/NetworkInput.h"/>
    <Include File="Source/NetworkInput/NetworkInputHistory.h"/>
    <Include File="Source/NetworkInput/NetworkInputVector.h"/>
    <Include File="AzNetworking/DataStructures/ByteBuffer.h"/>

    <NetworkProperty Type="Multiplayer::ClientInputId" Name="LastInputId" Init="Multiplayer::ClientInputId{0}" ReplicateFrom="Authority" ReplicateTo="Authority" IsRewindable="false" IsPredictable="false" IsPublic="false" Container="Object" ExposeToEditor="false" GenerateEventBindings="false" />

    <RemoteProcedure Name="SendClientInput" InvokeFrom="Autonomous" HandleOn="Authority" IsPublic="true" IsReliable="false" CanScript="false" Description="Client to server move / input RPC">
        <Param Type="Multiplayer::NetworkInputVector" Name="inputArray"  />
        <Param Type="uint32_t" Name="stateHash" />
        <Param Type="AzNetworking::PacketEncodingBuffer" Name="clientState" Description="This is for debugging desyncs only; release games should not populate this parameter" />
    </RemoteProcedure>

    <RemoteProcedure Name="SendClientInputCorrection" InvokeFrom="Authority" HandleOn="Autonomous" IsPublic="true" IsReliable="false" CanScript="false" Description="Autonomous proxy correction RPC">
        <Param Type="Multiplayer::ClientInputId" Name="inputId" />
        <Param Type="AzNetworking::PacketEncodingBuffer" Name="correction" />
    </RemoteProcedure>

    <RemoteProcedure Name="SendMigrateClientInput" InvokeFrom="Autonomous" HandleOn="Authority" IsPublic="true" IsReliable="false" CanScript="false" Description="Client to server migrate move / input RPC">
        <Param Type="Multiplayer::MigrateNetworkInputVector" Name="inputArray" />
    </RemoteProcedure>
</Component>
