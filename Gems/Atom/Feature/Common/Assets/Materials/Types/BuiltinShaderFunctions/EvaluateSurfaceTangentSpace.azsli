/*
 * Copyright (c) Contributors to the Open 3D Engine Project.
 * For complete copyright and license terms please see the LICENSE at the root of this distribution.
 *
 * SPDX-License-Identifier: Apache-2.0 OR MIT
 *
 */

 #pragma once

 #include <Atom/RPI/TangentSpace.azsli>

// Write out the tangent space corresponding to a given UV set
void EvaluateSurfaceTangentSpace(
    float3 tangent,
    float3 bitangent,
    float2 uv,
    uint uvIndex,
    out float3 outTangent,
    out float3 outBitangent)
{
    if (DrawSrg::GetTangentAtUv(uvIndex) == 0)
    {
        // This tangent space is supplied directly
        outTangent = tangent;
        outBitangent = bitangent;
    }
    else
    {
        // NOTE: SurfaceGradientNormalMapping_Init is expected to be called in advance

        // This tangent space needs to be generated using screenspace gradients
        SurfaceGradientNormalMapping_GenerateTB(uv, outTangent, outBitangent);
    }
}